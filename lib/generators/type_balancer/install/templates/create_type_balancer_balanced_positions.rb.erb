# frozen_string_literal: true

class CreateTypeBalancerBalancedPositions < ActiveRecord::Migration[7.0]
  def change
    create_table :type_balancer_balanced_positions do |t|
      t.references :record, polymorphic: true, null: false
      t.integer :position, null: false
      t.string :cache_key, null: false
      t.string :type_field
      t.timestamps

      t.index [:cache_key, :position], unique: true
      t.index [:record_type, :record_id, :cache_key],
              unique: true,
              name: "index_type_balancer_positions_on_record_and_cache"
    end
  end
end 